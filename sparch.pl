#! /usr/bin/perl
use v5.30;
use strict;
use warnings;
use Archive::Tar;
use MIME::Base64;
use Getopt::Long;

my $run = 1;
my $keep = 0;
my $compression = "xz";
my $temp_file = "NI0hvWMnltlvZat9";

# Process commandline options
GetOptions(
  'no-run' => sub{ $run = 0 },
  'keep' => \$keep 
) or (show_options_error() && exit 1);

mkdir "sparch";
chdir "sparch";

# Open a temporary working file
open(my $temp_handle, '>', $temp_file) or die "Cannot open temporary file: $!";
binmode $temp_handle;

# Base64-decode the data attached to this script
my $base64_data = <DATA>;
print $temp_handle decode_base64($base64_data);
close $temp_handle;

# Decompress and extract the file archive
Archive::Tar->extract_archive($temp_file, $compression);

my $done = do './bin/install' if $run;
if($!) {
  die "$done: $!\n";
}

unlink $temp_file;
chdir '..';
unlink $0 unless $keep;

sub show_options_error {
  say <<EOHELP;
USAGE:
  --keep
    Keep the archive after extraction. By default the original archive is deleted after extraction.

  --no-run
    Do not run script after extraction. If the archive was created with a --script option,
    the script will be executed after extraction. --no-run prevents the script from running.
EOHELP

  return 1;
}

# Attached tar archive compressed and base64 encoded
__DATA__
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